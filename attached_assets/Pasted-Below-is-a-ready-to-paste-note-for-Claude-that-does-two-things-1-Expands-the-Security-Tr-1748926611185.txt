Below is a **ready-to-paste note for Claude** that does two things:

1. **Expands the ‚ÄúSecurity & Transparency‚Äù settings panel** so it now governs *every* risk surface we‚Äôve discussed, shipped with a **Safety Mode (ON by default)** preset.
2. **Answers each of Claude‚Äôs clarification questions** in bullet form, so he can update the Phase-2 draft without ping-pong.

---

## üõ°Ô∏è  Security & Transparency Settings Panel ‚Äî Spec v0.3

| Section                        | Key / Toggle                                              | Default (Safety Mode = ON) | Notes & Phase-3 plan                                                                                           |
| ------------------------------ | --------------------------------------------------------- | -------------------------- | -------------------------------------------------------------------------------------------------------------- |
| **A. Model Governance**        | `modelRegistryMode` = `‚ÄúsignedOnly‚Äù \| ‚ÄúunsignedAllowed‚Äù` | **`signedOnly`**           | Requires Sigstore-signed commits for any new `llm.config.json` entry.<br>Phase-3: Cloud model keys added here. |
|                                | `isolatedRunByDefault` (bool)                             | **true**                   | All *new* model revisions first run inside an isolated container.                                              |
| **B. Chain-of-Thought**        | `cotMode` = `‚Äúfull‚Äù \| ‚Äúsummary‚Äù \| ‚Äúoff‚Äù`                | **`summary`**              | Full for local preset, summary for cloud; user can override.                                                   |
|                                | `cotMaxBytes` (int)                                       | **20 000**                 | Hash-only fallback above this size.                                                                            |
|                                | `cotHotDays` (int)                                        | **30**                     | Moves to cold archive after.                                                                                   |
| **C. Audit & Logs**            | `auditHotDays` (int)                                      | **90**                     | Live searchable.                                                                                               |
|                                | `auditColdGB` (int)                                       | **5**                      | Compressed, encrypted, FIFO deletion.                                                                          |
|                                | `incidentBroadcast` (bool)                                | **true**                   | Pushes critical errors to DevShell + e-mail webhook.                                                           |
| **D. DevShell Permissions**    | `devShellWriteMode` = `‚Äúproposal‚Äù \| ‚Äúdirect‚Äù`            | **`proposal`**             | All writes produce `.patch` waiting for approval.                                                              |
|                                | `devShellSandboxPaths[]`                                  | **\[`/src`,`/docs`]**      | Paths outside list are RO.                                                                                     |
| **E. Tool Executor Firewalls** | `toolCapabilityTokens` (string\[])                        | **empty**                  | No plugin may execute a tool unless user grants token.                                                         |
|                                | `maxToolCallsPerTask` (int)                               | **3**                      | Thwarts runaway loops.                                                                                         |
| **F. Mock / Test Harness**     | `mockLatencyJitterMs` (range)                             | **100‚Äì600**                | Forces retry logic during Phase-2 tests.                                                                       |
|                                | `mockErrorRatePct` (0-100)                                | **5**                      | Random timeouts/syntax errors.                                                                                 |
| **G. Migration Safety**        | `preMigrationSnapshot` (bool)                             | **true**                   | Zip + hash stored in `snapshots/`.                                                                             |
|                                | `autoRollbackOnError` (bool)                              | **true**                   | If migration script exits non-zero, DB restored.                                                               |

*All settings persisted in `user_settings.privacy_config` JSON and editable via `/api/settings/privacy`.*

---

## üìå  Answers to Claude‚Äôs Outstanding Questions

| Claude‚Äôs Q                                              | Short Answer                                                                                             | Where it lives in panel                                   |
| ------------------------------------------------------- | -------------------------------------------------------------------------------------------------------- | --------------------------------------------------------- |
| **1. LLM Source-of-Truth** ‚Äì single file or per-plugin? | Single **signed** `models/llm.config.json`; plugins may *propose* additions via DevShell proposals only. | A-1 `modelRegistryMode` + DevShell section                |
| **2. Migration Philosophy** ‚Äì freeze vs live?           | **In-place, but snapshot first + auto-rollback**.                                                        | G-section (`preMigrationSnapshot`,`autoRollbackOnError`)  |
| **3. DevShell Permissions** ‚Äì RO vs RW?                 | **Read-only** by default; writes require human-approved patch.                                           | D-section (`devShellWriteMode`, `devShellSandboxPaths[]`) |
| **4. Audit Retention** ‚Äì age or size?                   | **Both**: 90-day hot, 5 GB cold FIFO delete.                                                             | C-section (`auditHotDays`, `auditColdGB`)                 |
| **5. Mock Fidelity** ‚Äì simple or stochastic?            | Use **stochastic mocks**: 100-600 ms jitter & 5 % error rate.                                            | F-section (`mockLatencyJitterMs`, `mockErrorRatePct`)     |
| **CoT defaults for cloud models?**                      | Default `summary`, overridable to `full` with policy warning banner.                                     | B-section (`cotMode`)                                     |
| **PII redaction approach?**                             | Regex first; optional LLM scrubber toggle later.                                                         | Built into CoT storage pipeline (no extra knob yet).      |
| **Hot retention window adequacy?**                      | 30 days for CoT, 90 days for full audit.                                                                 | B- & C-sections                                           |

---

### How Claude Should Use This

1. **Insert the table contents** into the Phase-2 draft under a new **Theme: Security & Transparency Config**.
2. **Make Safety Mode** the default preset for all fresh installs.
3. Tag every earlier mention of CoT, audit, DevShell writes, migrations, tool calls with ‚Äú(configurable in Security panel)‚Äù.

Feel free to pass this note verbatim to Claude. It‚Äôs structured, unambiguous, and maps directly to implementation tasks.
